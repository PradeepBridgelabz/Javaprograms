package com.bridgelab.ooprograms;

import java.io.BufferedReader;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;

import org.json.simple.JSONArray;
import org.json.simple.JSONObject;
import org.json.simple.parser.JSONParser;
import org.json.simple.parser.ParseException;

import com.bridgelab.utility.Utility;

public class PatientModel 
{

	private int id,age;
	private String mobileNumber;
	Utility utility;
	String file="/home/bridgeit/Json/PatientLIst.json";
	JSONArray jsonArray=new JSONArray();
	JSONObject jsonObject=new JSONObject();
		public PatientModel(int patientId, String mobileNumber, int age2) throws IOException, ParseException {
		this.id=patientId;
		this.mobileNumber=mobileNumber;
		this.age=age;
		FileReader fr=new FileReader(file);
		BufferedReader br=new BufferedReader(fr);
		if(br.readLine()==null)
		{
			AddingToJsonObject(jsonArray,patientId,mobileNumber,age2);
		}
		else
		{
			jsonArray=getcurrentJsonObject();
			AddingToJsonObject(jsonArray,patientId,mobileNumber,age2);
			
		}
		}
		private JSONArray getcurrentJsonObject() throws IOException, ParseException {
		     JSONParser jsonParser=new JSONParser();
		     JSONObject obj=(JSONObject) jsonParser.parse(new FileReader(file));
		     JSONArray jsonArray=(JSONArray)obj.get("Patients");
		     
			return jsonArray;
		}
		private void AddingToJsonObject(JSONArray jsonArray, int patientId, String mobileNumber, int age) {
			JSONObject jsonObject1=new JSONObject();
			jsonObject1.put("PatientId", patientId);
			jsonObject1.put("MobileNumber", mobileNumber);
			jsonObject1.put("age", age);
			jsonArray.add(jsonObject1);
		    jsonObject.put("Patients", jsonArray);
			
		}
		public int getId()
		{
			return id;
		}
		public String getmobileNumber()
		{
			return mobileNumber;
		}
		public int getAge()
		{
			return age;
		}
		public String toString()
		{
			return id+" "+mobileNumber+" "+age+"\n";
		}
}
